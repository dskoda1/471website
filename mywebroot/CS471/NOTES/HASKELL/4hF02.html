<!DOCTYPE doctype PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html><head>




  
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

  
  <meta name="Author" content="Eileen Head and Les Lander">

  
  <meta name="GENERATOR" content="Mozilla/4.76 [en] (Windows NT 5.0; U) [Netscape]"><title>Haskell - List comprehension</title></head><body>

&nbsp;


<center>
<h3> Haskell 3</h3>

</center>



<h4> Propose:</h4>

<ul>

  <li> To examine lists in greater details.</li>

  <li>Infinite Data Structures in Haskell.<br>

  </li>

</ul>

<a href="http://bingweb.binghamton.edu/%7Ehead/CS471/CODE/Scripts/Notes1.lhs">
Notes1.lhs</a> has codes presented in these notes as well as other
examples.
<center>
<h4>
<hr width="100%"></h4>

</center>

<h3> List comprehension</h3>

<ul>

  
  <pre>[&lt;expr&gt; | &lt;generators&gt;, &lt;filters&gt;]</pre>

denotes a finite or infinite list,
  
  <pre>...&gt; [(n,n) | n &lt;- [2,4..10]]<br>[(2,2),(4,4),(6,6),(8,8),(10,10)]</pre>

  <li> The symbol "&lt;-" reads as "belongs to" "x &lt;- xs"&nbsp; is
called the generator.</li>

  
  <pre>...&gt; [n*n | n &lt;- [1,4..]]<br>[1,16,49,100,169,256,361...<br>&lt;interrupted&gt;</pre>

</ul>

<h3> Example</h3>

<ul>

  
  <pre>...&gt;[(x,y) |x&lt;-[1..3],y&lt;-[3,7]]<br>[(1,3),(1,7),(2,3),(2,7),(3,3),(3,7)]</pre>

  
  <pre>...&gt;[(+) x y |x&lt;-[1..3],y&lt;-[3,7]]<br>[4,8,5,9,6,10]</pre>

  <li> The second example would be more complicated without list
comprehensions</li>

  
  <pre>&gt;&nbsp;&nbsp; addLists::[Int]-&gt;[Int]-&gt;[Int]</pre>

  
  <pre>&gt;&nbsp;&nbsp; addLists list1 [] = []<br>&gt;&nbsp;&nbsp; addLists list1 (a:x) = addListElem list1 a ++ addLists list1 x</pre>

  
  <pre>&gt;&nbsp;&nbsp; addListElem [] a = []<br>&gt;&nbsp;&nbsp; addListElem (b:x) a = (b+a):addListElem x a</pre>

  <li> A third example illustrating two generators and a filter:</li>

  <br>

  <tt>&gt; [(x,y)| x &lt;- [1 .. 5], y &lt;- [1 .. x], x+y &lt; 10]</tt>
  <br>

  <tt>[(1,1),(2,1),(2,2),(3,1),(3,2),(3,3),(4,1),(4,2),(4,3),(4,4),(5,1),(5,2),(5,3),(5,4)]</tt><br>

  <br>

  <li>List Comprehension is "syntactic sugar" for a combination of
applications of the functions, concat, map and filter (HOF will be
covered later). The above can be expressed as: </li>

  
  <p><tt><b>&gt; </b>filter p (<a href="http://bingweb.binghamton.edu/%7Ehead/CS471/NOTES/HASKELL/4hFall00.html#concat">
concat</a> (map (\ x -&gt; map (\ y -&gt; (x,y))</tt> <br>

  <tt>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
[1..x]) [1..5]))</tt> <br>

  <tt>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
where</tt> <br>

  <tt>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
p (x,y) = x+y &lt; 10</tt> </p>

  
  <h5> from <a href="http://foldoc.doc.ic.ac.uk/foldoc/foldoc.cgi?query=List+Comprehension&amp;action=Search">
FOLDOC</a>&nbsp;<br>

also see <a href="http://www.numeric-quest.com/haskell/hcompanion/principles.html#List%20comprehension">
Haskell Companion</a> <br>

see&nbsp;<a href="http://web.archive.org/web/20010519122125/www.numeric-quest.com/haskell/hcompanion/keys.shtml">web.archive.org</a>
  </h5>

</ul>

<hr size="2" width="100%">
<h3> Two-line wonders</h3>

<ul>

  <li> Making a list of prime numbers</li>

  
  <pre>&gt;&nbsp;&nbsp; primes :: [Int]<br>&gt;&nbsp;&nbsp; primes = sieve [2..]<br>&gt;&nbsp;&nbsp; sieve (a:x) = a:sieve[y| y&lt;-x, y`mod`a &gt; 0]<br>&gt;&nbsp;&nbsp; sieve [] = []</pre>

</ul>

<h3> How does this work?</h3>

<ul>

  
  <pre>&gt; sieve (a:x) = a : sieve[y | y&lt;-x, y`mod`a &gt; 0]<br><br>sieve [2,3,4,5,6,7,8,&#8230;]<br>~&gt; 2:sieve[y| y&lt;-[3,4,5,...], y `mod` 2 &gt; 0] <br>~&gt; 2:sieve[3,5,7,9,11,13,15,...]<br>~&gt; 2:3:sieve[y| y&lt;-[5,7,11,13,17,19,...] y `mod` 3 &gt; 0]<br>~&gt; 2:3:sieve[5,7,11,13,17,19,...]<br>...<br>~&gt; 2:3:5:sieve[7,11,13,17,19,...]</pre>

  <li>Values are generated only as needed.<br>

  </li>

  <li> You should execute "primes" in Haskell. Since it produces an
unbounded list, you will have to STOP the execution using the "Stop"
icon.</li>

  <li>OR use "<tt>take 10 primes"</tt> which generates the first 10
primes.<br>

  </li>

</ul>

<h3> Mersenne primes</h3>

<ul>

  <li> To get a few primes:</li>

  
  <pre>...&gt; sieve [2..200]</pre>

  <li> To find Mersenne primes (those of the form 2<i><sup>n</sup></i>
- 1):</li>

  
  <pre>...&gt; [p|p &lt;- primes, powerOf2 (p+1)]</pre>

  
  <pre>&gt;&nbsp;&nbsp; powerOf2 1 = False<br>&gt;&nbsp;&nbsp; powerOf2 2 = True<br>&gt;&nbsp;&nbsp; powerOf2 n = isEven n &amp;&amp; powerOf2 (n `div` 2)</pre>

</ul>

<h3> List examples</h3>

<ul>

  <li> Note that</li>

  
  <pre>[6..12] is [6,7,8,9,10,11,12]</pre>

  
  <pre>['d'..'h'] is "defgh"<br><br>[6,9..20] is [6,9,12,15,18]</pre>

  
  <pre>['d','g'..'p'] is "dgjmp"<br><br>[2..] is [2,3,4,5,6,7,8,9,10...</pre>

  
  <pre>['d','q'..] is "dq~\139\152\165\178\191\204\217\230\243"</pre>

</ul>

<h3> Permutations</h3>

<ul>

  
  <pre>&gt;&nbsp;&nbsp; perms :: Eq t =&gt; [t] -&gt; [[t]]<br>&gt;&nbsp;&nbsp; perms [] = [[]]<br>&gt;&nbsp;&nbsp; perms x = [a:p | a &lt;- x, p &lt;- perms(x\\[a])]</pre>

  <li> Try executing the permutation function</li>

  
  <pre>...&gt; perms [1,2,3,4,5]<br>[[1,2,3,4,5],[1,2,3,5,4],[1,2,4,3,5],[1,2,4,5,3], ... [5,4,3,2,1]]</pre>

</ul>

<h3>
<hr size="1" width="100%"></h3>

<h3> List module</h3>

<ul>

  <li> Notice that we are importing a function from the List module</li>

  <li> The example file (<a href="http://bingweb.binghamton.edu/%7Ehead/CS471/CODE/Scripts/ExampleL.lhs">
ExampleL.lhs</a>) can be copied</li>

  <li> It begins</li>

  
  <pre>&gt;&nbsp;&nbsp; module ExampleL where<br>&gt;&nbsp;&nbsp; import List<br>&gt;&nbsp;&nbsp; ...</pre>

</ul>

<h3> Using a function in List</h3>

<ul>

  <li> Please note that you cannot use &#8220;\\&#8221; to remove
elements from a list unless you import the module List</li>

  <li> Otherwise, define it:</li>

  
  <pre>&gt;&nbsp;&nbsp; (\\) :: Eq a =&gt; [a]-&gt;[a]-&gt;[a]<br>&gt;&nbsp;&nbsp; (\\) (a:x) [] = a:x<br>&gt;&nbsp;&nbsp; (\\) x (b:y) = (rmvAux b x)\\y<br>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; where&nbsp; rmvAux _ [] = []<br>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rmvAux b (a:x) =&nbsp;<br>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if a == b then x&nbsp;<br>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else a:rmvAux b x</pre>

</ul>

<h3> Member</h3>

<ul>

  <li> Member:</li>

  
  <pre>&gt;&nbsp;&nbsp; member a [] = False<br>&gt;&nbsp;&nbsp; member a (b:x) = (a==b) || member a x</pre>

  
  <pre>alternatively</pre>

  
  <pre>&gt;&nbsp;&nbsp; member a [] = False<br>&gt;&nbsp;&nbsp; member a (b:x)<br>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | a == b&nbsp;&nbsp;&nbsp; = True<br>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | otherwise = member a x</pre>

  
  <pre>...&gt; member 3 [1,2,3,4]<br>True</pre>

</ul>

<hr size="1" width="100%">
<h3> <a name="Fib"></a>&nbsp; Fibonacci:</h3>

<ul>

  <big><tt>&gt;&nbsp; fib 0 = 1</tt> <br>

  <tt>&gt;&nbsp; fib 1 = 1</tt> <br>

  <tt>&gt;&nbsp; fib n</tt> <br>

  <tt>&gt;&nbsp;&nbsp;&nbsp; | n &gt; 1&nbsp;&nbsp;&nbsp; = fib(n-1) +
fib(n-2)</tt> <br>

  <tt>&gt;&nbsp;&nbsp;&nbsp; |otherwise = error "n&gt;0 pls."</tt></big>
  
  <p><big>&gt; <b><tt>slowFibSeq = [fib n | n &lt;- [1..]]</tt></b> </big><br>

&nbsp; <br>

&nbsp; </p>

  <li> Using infinite data structures to define the&nbsp;Fibonacci
series.&nbsp; This is more efficient computation.</li>

  <big><br>

  <tt>&gt; fibSeq&nbsp;&nbsp; = 1 : 1 : [ f | f &lt;- zipWith (+)
fibSeq (tail fibSeq)]</tt> <br>

  <tt>&gt; nFib n = fibSeq</tt><span style="font-family: monospace;">&nbsp; </span></big><span style="font-family: monospace;">!!&nbsp; n </span><br>

&nbsp;
  
  <h6> &nbsp;<a href="http://haskell.org/tutorial/functions.html">See
Gentle Tutorial</a> for a discussion on circular list.</h6>

  <li>Use this idea to generate factorial</li>

</ul>

<blockquote><tt>&gt; factseq</tt> <b><tt>= 1 : 1 : [ f | f &lt;-
zipWith (*) (tail factseq) [2 ..] ]</tt></b><br>

  
  <ul>

    <li>This can be with just function application &nbsp;and infinite
data structures</li>

  
  </ul>

  <tt>&gt; factseq</tt> <b><tt>= 1 : 1 : zipWith (*) (tail factseq) [2
..]</tt></b></blockquote>

<ul>

  <br>

  <li>Alternative to above</li>

</ul>

<blockquote><tt>&gt;<big> fibSeq2 &nbsp; = 1 : 1 : [ x+y | (x,y) &lt;-
zip fibSeq2 (tail fibSeq2) ]</big></tt><big> </big><br>

</blockquote>

<ul>

  <li>Using the switch -98 on the hugs command runs an extended version
of Haskell which allows the following:</li>

</ul>

<blockquote><tt>&gt;<big> fibSeq3 &nbsp; = 1 : 1 : [ x+y | x &lt;-
fibSeq3 | y&lt;- (tail fibSeq3)]<br>

  </big><br>

  </tt></blockquote>

<ul>

  <li>If the Fibonacci sequence starts with 0:1:. then the following
property holds</li>

</ul>

<blockquote><big><b><tt>&nbsp; gcd (fib !! m) (fib !! n) == fib !!
(gcd m n)</tt></b></big><br>

</blockquote>

<h3> One Last Neat example: Quicksort using list comprehension<br>

</h3>


  
<div style="margin-left: 40px;"><tt>&gt; quicksort&nbsp; []&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp; []</tt><br>
<tt>&gt; quicksort (x:xs)&nbsp; =&nbsp; quicksort [y | y &lt;- xs,
y&lt;x ]</tt><br>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
++ [x]</tt><br>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
++ quicksort [y | y &lt;- xs, y&gt;=x]</tt><br>
</div>

  
  
  <tt><br>
</tt><br>
<br>
<h3>Python</h3>
Lazy evaluation:<br>
<ul>
  <li>Using iterators</li>
</ul>
<span style="font-family: monospace;">def iteratorC():</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; yield 1</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; yield 2</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; yield 3</span><span style="font-family: monospace;"><br>
&nbsp;<br>
</span><span style="font-family: monospace;">def fib():</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; fn2 = 1&nbsp;</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; fn1 = 1&nbsp;</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; while True:</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (fn1,fn2,oldfn2) = (fn1+fn2,fn1,fn2)</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; yield oldfn2</span><br>
<ul>
  <li>Using objects</li>
</ul>
<span style="font-family: monospace;">class fibnum:</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def __init__(self):</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.fn2 = 1 # "f_{n-2}"</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.fn1 = 1 # "f_{n-1}"</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def next(self):</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (self.fn1,self.fn2,oldfn2) = (self.fn1+self.fn2,self.fn1,self.fn2)</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return oldfn2</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def __iter__(self):</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return self</span><br>
<br>
List comprehension:<br>
<div style="margin-left: 40px; font-family: monospace;">...&gt; s = [x**2 for x in range(10)]<br>
...&gt;&nbsp;s<br>
[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]<br>
...&gt; [x for x in s if x % 2 == 0]<br>
&nbsp; &nbsp; &nbsp;[0, 4, 16, 36, 64]<br>
<br>
</div>
<div style="margin-left: 40px;"><span style="font-family: monospace;">def iteratorC():</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; yield 1</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; yield 2</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; yield 3<br>
<br>
<br>
...&gt; [x for x in iteratorC()]<br>
[1,2,3]</span></div>


<hr noshade="noshade" width="100%">
<div style="text-align: left;"><a href="http://wiki.python.org/moin/PythonVsHaskell">PythonVsHaskell</a><br>
<a href="http://books.google.com/books?id=1Shx_VXS6ioC&amp;pg=PT189&amp;lpg=PT189&amp;dq=Translating+List+Comprehension+from+Haskell+to+Python&amp;source=bl&amp;ots=BC41bGWgI9&amp;sig=4UHTDVvt6D_zdxMpHLqIA0AYCD0&amp;hl=en&amp;sa=X&amp;ei=iTShT6UU6bLpAfT24YwJ&amp;ved=0CE8Q6AEwBw#v=onepage&amp;q=Translating%20List%20Comprehension%20from%20Haskell%20to%20Python&amp;f=false">Python Cookbook</a> -- Constructing Lists with List Comprehensions <br>

</div>

<hr align="left" noshade="noshade" width="100%"> <br>

<br>

<br>

<br>

<br>

<br>

</body></html>